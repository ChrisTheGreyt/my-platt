version: 1
applications:
  - appRoot: ttc-app
    frontend:
      phases:
        preBuild:
          commands:
            - npm install
            - npm install -g pnpm
            - pnpm install tailwindcss postcss autoprefixer
            - |
              cat << EOF > tailwind.config.js
              /** @type {import('tailwindcss').Config} */
              module.exports = {
                content: [
                  './src/**/*.{js,ts,jsx,tsx,mdx}',
                  './app/**/*.{js,ts,jsx,tsx,mdx}'
                ],
                theme: { extend: {} },
                plugins: []
              };
              EOF
            - |
              cat << EOF > postcss.config.js
              module.exports = {
                plugins: {
                  'tailwindcss': require('tailwindcss'),
                  'autoprefixer': require('autoprefixer')
                }
              };
              EOF
            - npm list tailwindcss
            - npm list postcss
            - npm list autoprefixer
        build:
          commands:
            - npm run build
      artifacts:
        baseDirectory: .next
        files:
          - '**/*'
      cache:
        paths:
          - node_modules/**/* 